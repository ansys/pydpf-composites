
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/gallery_examples/failure_operator_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_gallery_examples_failure_operator_example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_gallery_examples_failure_operator_example.py:


.. _failure_operator_example:

Composite failure operator
--------------------------

This operator computes the minimum and maximum failure values and failure modes
of a combined failure criterion. A combined failure criterion is a selection of
failure criteria such as Puck, Tsai-Wu, Face Sheet Wrinkling...

The combined failure criterion allows you to assess different type of materials
and failure modes at once. The scoping enables to evaluate of the min and max
failure per element, or to select a list of materials or plies.

.. GENERATED FROM PYTHON SOURCE LINES 17-18

Load ansys libraries

.. GENERATED FROM PYTHON SOURCE LINES 18-36

.. code-block:: default

    import ansys.dpf.core as dpf

    from ansys.dpf.composites import ResultDefinition
    from ansys.dpf.composites.example_helper.example_helper import (
        connect_to_or_start_server,
        get_continuous_fiber_example_files,
    )
    from ansys.dpf.composites.failure_criteria import (
        CombinedFailureCriterion,
        CoreFailureCriterion,
        MaxStrainCriterion,
        MaxStressCriterion,
        VonMisesCriterion,
    )

    server_context = connect_to_or_start_server()
    composite_files_on_server = get_continuous_fiber_example_files(server_context, "shell")








.. GENERATED FROM PYTHON SOURCE LINES 37-38

Definition of the combined failure criterion

.. GENERATED FROM PYTHON SOURCE LINES 38-50

.. code-block:: default

    def get_combined_failure_criterion() -> CombinedFailureCriterion:
        max_strain = MaxStrainCriterion()
        max_stress = MaxStressCriterion()
        core_failure = CoreFailureCriterion()
        von_mises_strain_only = VonMisesCriterion(vme=True, vms=False)

        return CombinedFailureCriterion(
            name="failure of all materials",
            failure_criteria=[max_strain, max_stress, core_failure, von_mises_strain_only],
        )









.. GENERATED FROM PYTHON SOURCE LINES 51-53

Define the result definition which is used to configure the composite_failure_operator
Process all elements

.. GENERATED FROM PYTHON SOURCE LINES 53-66

.. code-block:: default

    rd = ResultDefinition(
        name="combined failure criteria",
        rst_files=[composite_files_on_server.rst],
        material_files=[composite_files_on_server.engineering_data],
        composite_definitions=[composite_files_on_server.composite_definitions],
        combined_failure_criterion=get_combined_failure_criterion(),
    )

    fc_op = dpf.Operator("composite::composite_failure_operator")
    fc_op.inputs.result_definition(rd.to_json())

    output_all_elements = fc_op.outputs.fields_containerMax()








.. GENERATED FROM PYTHON SOURCE LINES 67-69

Plot the max IRF per element


.. GENERATED FROM PYTHON SOURCE LINES 69-75

.. code-block:: default

    failure_value_index = 1
    failiure_mode_index = 0

    irf_field = output_all_elements[failure_value_index]
    irf_field.plot()




.. image-sg:: /examples/gallery_examples/images/sphx_glr_failure_operator_example_001.png
   :alt: failure operator example
   :srcset: /examples/gallery_examples/images/sphx_glr_failure_operator_example_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 76-77

Scope failure evaluation to certain

.. GENERATED FROM PYTHON SOURCE LINES 77-83

.. code-block:: default

    rd.element_scope = [1, 3]
    fc_op.inputs.result_definition(rd.to_json())
    output_two_elements = fc_op.outputs.fields_containerMax()
    irf_field = output_two_elements[failure_value_index]
    irf_field.plot()




.. image-sg:: /examples/gallery_examples/images/sphx_glr_failure_operator_example_002.png
   :alt: failure operator example
   :srcset: /examples/gallery_examples/images/sphx_glr_failure_operator_example_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 84-85

Scope by plies

.. GENERATED FROM PYTHON SOURCE LINES 85-91

.. code-block:: default

    rd.element_scope = []
    rd.ply_scope = ["P1L1__ud_patch ns1"]
    fc_op.inputs.result_definition(rd.to_json())
    output_woven_plies = fc_op.outputs.fields_containerMax()
    irf_field = output_woven_plies[failure_value_index]
    irf_field.plot()



.. image-sg:: /examples/gallery_examples/images/sphx_glr_failure_operator_example_003.png
   :alt: failure operator example
   :srcset: /examples/gallery_examples/images/sphx_glr_failure_operator_example_003.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  1.231 seconds)


.. _sphx_glr_download_examples_gallery_examples_failure_operator_example.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: failure_operator_example.py <failure_operator_example.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: failure_operator_example.ipynb <failure_operator_example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
